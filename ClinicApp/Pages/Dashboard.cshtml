@page
@model ClinicApp.Pages.DashboardModel
@{
	ViewData["Title"] = "Dashboard de Clinica";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0 text-gray-800">Dashboard de Clinica</h1>
    <div>
        <span class="text-muted">Última actualización: @DateTime.Now.ToString("dd/MM/yyyy HH:mm")</span>
    </div>
</div>

<!-- Tarjetas de Métricas -->
<div class="row mb-4">
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-primary shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                            Total Pacientes
                        </div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.Dashboard.TotalPacientes</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-users fa-2x text-gray-300"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-success shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                            Citas de Hoy
                        </div>
						<div class="h5 mb-0 font-weight-bold text-gray-800">@Model.Dashboard.CitasHoy</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-calendar-check fa-2x text-gray-300"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-info shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                            Médicos Disponibles
                        </div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.Dashboard.MedicosDisponibles</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-user-md fa-2x text-gray-300"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-warning shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                            Salas Ocupadas
                        </div>
                        <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.Dashboard.SalasOcupadas</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-door-open fa-2x text-gray-300"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Tablas de Datos -->
<div class="row">
    <!-- Citas Recientes -->
    <div class="col-lg-6">
        <div class="card shadow mb-4">
            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                <h6 class="m-0 font-weight-bold text-primary">Citas Recientes</h6>
                <a asp-page="/Citas/Index" class="btn btn-primary btn-sm">Ver Todas</a>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Fecha</th>
                                <th>Paciente</th>
                                <th>Médico</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
							@foreach (var cita in Model.Dashboard.CitasRecientes)
                            {
                                <tr>
                                    <td>@cita.Id</td>
                                    <td>@cita.FechaHora.ToString("dd/MM HH:mm")</td>
                                    <td>@cita.PacienteNombre</td>
                                    <td>@cita.MedicoNombre</td>
                                    <td>
                                        <span class="badge @(cita.Estado == "Completada" ? "bg-success" :
                                                            cita.Estado == "Pendiente" ? "bg-warning" : "bg-danger")">
                                            @cita.Estado
                                        </span>
                                    </td>
                                    <td>
                                        <a asp-page="/Citas/Detalle" asp-route-id="@cita.Id" class="btn btn-sm btn-outline-primary">Ver</a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Pacientes Recientes -->
    <div class="col-lg-6">
		<div class="card shadow mb-4">
			<div class="card-header py-3 d-flex justify-content-between align-items-center">
				<h6 class="m-0 font-weight-bold text-primary">Pacientes Recientes</h6>
				<a asp-page="/Pacientes/Index" class="btn btn-primary btn-sm">Ver Todos</a>
			</div>
			<div class="card-body">
				<div class="table-responsive">
					<table class="table table-bordered">
						<thead>
							<tr>
								<th>Cédula</th>
								<th>Nombre</th>
								<th>Fecha Registro</th>
								<th>Estado</th>
								<th>Acciones</th>
							</tr>
						</thead>
						<tbody>
							@foreach (var paciente in Model.Dashboard.PacientesRecientes)
							{
								<tr>
									<td>@paciente.Cedula</td>
									<td>@paciente.NombreCompleto</td>
									<td>@paciente.FechaRegistro.ToString("dd/MM/yyyy")</td>
									<td>@paciente.Estado</td>
									<td>
										<a asp-page="/Pacientes/Detalle" asp-route-cedula="@paciente.Cedula"
										   class="btn btn-sm btn-info">Ver</a>
									</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			</div>
		</div>
    </div>
</div>